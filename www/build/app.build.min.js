!function(e){function t(e,t,n,a,r,o,s,i,c,u){n.debug("run"),o.ready(function(){n.debug("ready"),e.register(),"a"!==ionic.Platform.grade.toLowerCase()&&"b"!==ionic.Platform.grade.toLowerCase()&&t.views.transition("none"),"undefined"!=typeof cordova&&cordova.plugins.Keyboard&&cordova.plugins.Keyboard.hideKeyboardAccessoryBar(!0),"undefined"!=typeof cordova&&"undefined"!=typeof $cordovaKeyboard&&$cordovaKeyboard.hideAccessoryBar(!0),"undefined"!=typeof StatusBar&&(window.StatusBar.styleDefault(),window.StatuBar.overlaysWebView(!1)),"undefined"!=typeof cordova&&"android"===cordova.platformId&&StatusBar.backgroundColorByHexString("#EEEEEE")}).then(function(){"undefined"!=typeof navigator.splashscreen&&r(function(){navigator.splashscreen.hide()},500)}),i.$on("$stateChangeStart",function(e,t,n,a){navigator.onLine===!0?i.connection="online":i.connection="offline",i.online=navigator.onLine,"true"!==window.localStorage.auth&&"login"!==t.name&&(e.preventDefault(),c.go("login"))}),a.Cache(["img/bg-mild.jpg","img/bg-dark.jpg","img/bg-light.jpg","img/placeholder-rec.jpg","img/placeholder-square.jpg","img/icon.png"]).then(function(){n.debug("Images done loading!")},function(e){n.debug("Image failed: "+e)}),u.addEventListener("offline",function(){i.$apply(function(){i.online=!1,i.connection="offline"}),n.warn("you are now offline")},!1),u.addEventListener("online",function(){i.$apply(function(){i.online=!0,i.connection="online"}),n.warn("you are now online")},!1)}e.module("studentaccess",["ionic","ionic.service.core","ionic-material","ionic.service.analytics","ngCordova","pascalprecht.translate","dcbImgFallback","ionic.ion.imageCacheFactory","chart.js","LocalForageModule"]).run(["$ionicAnalytics","$ionicConfig","$log","$ImageCacheFactory","$timeout","$ionicPlatform","$cordovaSplashscreen","$rootScope","$state","$window",t]).constant("AUTH_EVENTS",{notAuthenticated:"auth-not-authenticated"})}(window.angular),function(e){function t(e,t,n,a,r){t.debugInfoEnabled(!0),e.debugEnabled(!0),n.translations("en",{"PULL-TO-REFRESH":"Pull to refresh...",LOGOUT:"Logout",SEARCH:"Search...","LOGIN-USER":"User ID","LOGIN-PASSWORD":"Password",LOGIN:"Login","LOGIN-LOADING":"Loading...","PROFILE-VIEW-TITLE":"Profile","PROFILE-BORN":"Born","PROFILE-ENROLLED":"You are in ","PROFILE-ENROLLED2":"th grade","PROFILE-BALANCE":"Credit","PROFILE-RECORDS":"Records","PROFILE-DOCUMENTS":"Documents","PROFILE-MISSING":"Missing Assignments","PROFILE-MISSING-WORTH":"Worth","PROFILE-MISSING-POINTS":"Points","CHECK-UR-GRADES":"Check your Grades","PROFILE-BALANCE-FAM":"Family Credits","PROFILE-CLASS-SCHEDULE":"Class Schedule","PROFILE-NO-SCHEDULE":"No Schedule Found!","HOMEWORK-VIEW-TITLE":"Homework","HOMEWORK-ASSIGNMENTS":"Today's homework","HOMEWORK-NOHOMEWORK":"There's no homework!","HOMEWORK-NOHOMEWORK-TEXT":"But that's not that bad... ;)","HOMEWORK-PICK-CLASS-FILTER":"Pick a Class","HOMEWORK-CLEAR-CLASS-FILTER":"Clear Filter","HOMEWORK-CANCEL-CLASS-FILTER":"Cancel","GRADES-VIEW-TITLE":"Grades","GRADES-WITHHELD":"Your grades have been withheld. Please pay the caja to restore them.","GRADES-TEACHER-PHONE":"Phone","GRADES-TEACHER-CONTACT":"Contact Info","GRADES-TEACHER-EMAIL":"Email","GRADES-CLASS-ROOM":"Room","GRADES-BREAKDOWN":"Grading Scale","GRADES-YOUR-GRADE":"Grade","GRADES-CLASS-AVERAGE":"Class Average","GRADES-CLASS-PERIOD":"Period","GRADES-CLASS-TERM":"Term","GRADES-LAST-UPDATED":"Last Update","GRADES-NOCLASSES":"No classes here... it could be worse ;)","GRADES-GRADES":"Grades","GRADES-NO-GRADES-LIST":"No grades found.","EVENTS-VIEW-TITLE":"Events","EVENTS-LOCATION":"Location","EVENTS-TIME":"Time","EVENTS-DATE":"Date","EVENTS-NOEVENTS":"THERE ARE NO EVENTS!","CAFETERIA-VIEW-TITLE":"Cafeteria","CAFETERIA-NOFOOD":"WE HAVE NO FOOOOOOOOD!","CAFETERIA-TODAYS-FOOD":"Today's lunch","CAFETERIA-BALANCE-HISTORY":"Balance History","CAFETERIA-TRANSACTION-METHOD":"Account","CAFETERIA-TRANSACTION-ITEM":"Item","CAFETERIA-TRANSACTION-AUTHORIZED-BY":"Authorized By","CAFETERIA-TRANSACTION-DATE-TIME":"Date-Time","CAFETERIA-TRANSACTION-PRICE":"Price","CAFETERIA-TRANSACTION-HISTORY":"Transaction History","CAFETERIA-SHOW-MORE":"Show More...","CAFETERIA-SHOW-LESS":"Show Less...","CAFETERIA-NOTHING-FOUND":"Nothing Found","CAFETERIA-STUDENT":"Student","CAFETERIA-FAMILY":"Family","CAFETERIA-NO-FAMILY-TRANSACTIONS":"No Family Transactions","CAFETERIA-NO-STUDENT-TRANSACTIONS":"No Student Transactions","STAFF-VIEW-TITLE":"Staff","STAFF-HOME-PHONE":"Home Phone","STAFF-PHONE":"CellPhone","STAFF-EMAIL":"Email","SETTINGS-VIEW-TITLE":"Settings","SETTINGS-SELECTED-LANG":"Selected Language","SETTINGS-SELECTED-THEME":"Selected Theme","SETTINGS-THEME-LIGHT":"Light","SETTINGS-THEME-DARK":"Dark","SETTINGS-THEME-MILD":"Mild","SETTINGS-SUGGESTIONS":"Suggestions","SETTINGS-YOUR-NAME":"Name","SETTINGS-SUGGESTION-SUBJECT":"Subject","SETTINGS-SUGGESTION-BODY":"Comment","SETTINGS-SUGGESTION-MAILUS":"Mail Us","SETTINGS-DELETE-PICS":"Delete Pics","SETTINGS-DELETE-PICS-MESSAGE":"For performance and data savings reasons, we store profiles pictures. You may wish to delete currently stored pictures for reasons unknown to  mankind;  ¯\\_(ツ)_/¯. Understand, this cannot be undone.","SETTINGS-NO-PICS":"No other pictures are stored.","SETTINGS-DELETE":"Delete","SETTINGS-CANCEL":"Cancel","SETTINGS-DELETE-TITLE":"Delete Stored pictures"}),n.translations("es",{"PULL-TO-REFRESH":"Hale para refrescar...",LOGOUT:"Salir",SEARCH:"Buscar...","LOGIN-USER":"ID de Usuario","LOGIN-PASSWORD":"Contraseña",LOGIN:"Entrar","LOGIN-LOADING":"Cargando...","PROFILE-VIEW-TITLE":"Perfil","PROFILE-BORN":"Nacido","PROFILE-ENROLLED":"Usted esta en ","PROFILE-ENROLLED2":"º grado","PROFILE-BALANCE":"Credito","PROFILE-RECORDS":"Registros","PROFILE-DOCUMENTS":"Documentos","PROFILE-MISSING":"Tareas Pendientes","PROFILE-MISSING-WORTH":"Valor","PROFILE-MISSING-POINTS":"Puntos","CHECK-UR-GRADES":"Revisar Notas","PROFILE-BALANCE-FAM":"Credito Familiar","PROFILE-CLASS-SCHEDULE":"Horario de Clases","PROFILE-NO-SCHEDULE":"No Se Encontró Horario!","HOMEWORK-VIEW-TITLE":"Tareas","HOMEWORK-ASSIGNMENTS":"Tareas del dia","HOMEWORK-NOHOMEWORK":"No hay tareas!","HOMEWORK-NOHOMEWORK-TEXT":"Pero eso no es tan malo... ;)","HOMEWORK-PICK-CLASS-FILTER":"Elegir Clase","HOMEWORK-CLEAR-CLASS-FILTER":"Todas las Clases","HOMEWORK-CANCEL-CLASS-FILTER":"Cancelar","GRADES-VIEW-TITLE":"Notas","GRADES-WITHHELD":"Tus notas han sido retenidas. Por favor pagar a la caja para restaurarlas","GRADES-TEACHER-PHONE":"Teléfono","GRADES-TEACHER-CONTACT":"Info de Contacto","GRADES-TEACHER-EMAIL":"Correo Electronico","GRADES-CLASS-ROOM":"Aula","GRADES-BREAKDOWN":"Escala","GRADES-YOUR-GRADE":"Nota","GRADES-CLASS-AVERAGE":"Promedio de Clase","GRADES-CLASS-PERIOD":"Periodo","GRADES-CLASS-TERM":"Semestre","GRADES-LAST-UPDATED":"Ultima Actualizacion","GRADES-NOCLASSES":"No hay classes... ;)","GRADES-GRADES":"Notas","GRADES-NO-GRADES-LIST":"No se encontraron notas.","EVENTS-VIEW-TITLE":"Eventos","EVENTS-LOCATION":"Lugar","EVENTS-TIME":"Hora","EVENTS-DATE":"Fecha","EVENTS-NOEVENTS":"NO HAY EVENTOS!","CAFETERIA-VIEW-TITLE":"Cafetería","CAFETERIA-NOFOOD":"NO HAY COMIIIIIIDA!","CAFETERIA-TODAYS-FOOD":"Almuerzo del dia","CAFETERIA-BALANCE-HISTORY":"Balance","CAFETERIA-TRANSACTION-METHOD":"Cuenta","CAFETERIA-TRANSACTION-ITEM":"Objeto","CAFETERIA-TRANSACTION-AUTHORIZED-BY":"Autorizado Por","CAFETERIA-TRANSACTION-DATE-TIME":"Fecha-Hora","CAFETERIA-TRANSACTION-PRICE":"Precio","CAFETERIA-TRANSACTION-HISTORY":"Transacciones","CAFETERIA-SHOW-MORE":"Mostrar Mas...","CAFETERIA-SHOW-LESS":"Mostrar Menos...","CAFETERIA-NOTHING-FOUND":"No se encontró nada","CAFETERIA-STUDENT":"Estudiante","CAFETERIA-FAMILY":"Familia","CAFETERIA-NO-FAMILY-TRANSACTIONS":"No Hay Trasacciones de Familia","CAFETERIA-NO-STUDENT-TRANSACTIONS":"No Hay Trasacciones del Estudiante","STAFF-VIEW-TITLE":"Personal","STAFF-HOME-PHONE":"Telefono","STAFF-PHONE":"Telefono Celular","STAFF-EMAIL":"Correo Electronico","SETTINGS-VIEW-TITLE":"Ajustes","SETTINGS-SELECTED-LANG":"Lenguaje Seleccionado","SETTINGS-SELECTED-THEME":"Tema Seleccionado","SETTINGS-THEME-LIGHT":"Claro","SETTINGS-THEME-DARK":"Oscuro","SETTINGS-THEME-MILD":"Tranquilo","SETTINGS-SUGGESTIONS":"Sugerencias","SETTINGS-YOUR-NAME":"Nombre","SETTINGS-SUGGESTION-SUBJECT":"Tema","SETTINGS-SUGGESTION-BODY":"Comentario","SETTINGS-SUGGESTION-MAILUS":"Enviar","SETTINGS-DELETE-PICS":"Borrar Fotos","SETTINGS-DELETE-PICS-MESSAGE":"Por rasones de rendimiento y ahorro de internet, las fotos de perfil se guardan localmente. Puede que usted quiera borrar las fotos de otras personas por razones no conocidas a la humanidad; ¯\\_(ツ)_/¯. Esto no se puede deshacer.","SETTINGS-NO-PICS":"No hay otras fotos guardadas.","SETTINGS-DELETE":"Borrar","SETTINGS-CANCEL":"Cancelar","SETTINGS-DELETE-TITLE":"Borrar Fotos Guardadas"}),n.preferredLanguage("en"),n.useSanitizeValueStrategy("escaped"),a.state("login",{url:"/login",templateUrl:"components/login/login.html",controller:"LoginCtrl as login"}).state("app",{url:"/app",abstract:!0,templateUrl:"components/menu/sidemenu.html",controller:"AppCtrl",controllerAs:"app"}).state("app.profile",{url:"/profile",views:{"master-view":{templateUrl:"components/profile/profile.html",controller:"ProfileCtrl as profile"}}}).state("app.homework",{url:"/homework",views:{"master-view":{templateUrl:"components/homework/homework.html",controller:"HomeworkCtrl as homework"}}}).state("app.grades",{url:"/grades",views:{"master-view":{templateUrl:"components/grades/grades.html",controller:"GradesCtrl as grades"}}}).state("app.grades.gradeDetails",{url:"/:PERIODID/:TEACHERID",views:{"master-view@app":{templateUrl:"components/grades/grades-details.html",controller:"GradesDetailsCtrl as gradesDetails"}}}).state("app.events",{url:"/events",views:{"master-view":{templateUrl:"components/events/events.html",controller:"EventsCtrl as events"}}}).state("app.events.eventDetails",{url:"/:EVENTID",views:{"master-view@app":{templateUrl:"components/events/event-details.html",controller:"EventsDetailsCtrl as eventsDetails"}}}).state("app.cafeteria",{url:"/cafeteria",views:{"master-view":{templateUrl:"components/cafeteria/cafeteria.html",controller:"CafeteriaCtrl as cafeteria"}}}).state("app.staff",{url:"/staff",views:{"master-view":{templateUrl:"components/staff/staff.html",controller:"StaffCtrl as staff"}}}).state("app.staff.staffDetails",{url:"/:STAFFID",views:{"master-view@app":{templateUrl:"components/staff/staff-details.html",controller:"StaffDetailsCtrl as staffDetails"}}}).state("app.settings",{url:"/settings",views:{"master-view":{templateUrl:"components/settings/settings.html",controller:"SettingsCtrl as settings"}}}),r.otherwise(function(e,t){e.get("$state").go("app.profile")})}e.module("studentaccess").config(["$logProvider","$compileProvider","$translateProvider","$stateProvider","$urlRouterProvider",t])}(window.angular),function(){function e(e,t,n,a,r,o,s){function i(e){d.cafeteriaMenu=e}function c(e){function t(e){return e.credhist_balance}function n(e){var t=e.credhist_datetime.replace(/\ .*/,"").split("-");return a[t[1]]+", "+t[2]}var a={"01":"Jan","02":"Feb","03":"Mar","04":"Apr","05":"May","06":"Jun","07":"Jul","08":"Aug","09":"Sep",10:"Oct",11:"Nov",12:"Dec"},r=$array.groupObjects($array.reverse(e))([function(e){return"Crédito del Cliente"===e.credhist_method||"Client Credit"===e.credhist_method},function(e){return"Crédito de la Familia"===e.credhist_method||"Family Credit"===e.credhist_method}]);return{student:{data:r[0].map(t),labels:r[0].map(n)},family:{data:r[1].map(t),labels:r[1].map(n)}}}function u(e,n){var r=n*-1;e&&n?e.data&&Array.isArray(e.data)&&e.labels&&Array.isArray(e.labels)&&e.labels.length>n?(d.chartLabels=t("limitTo")(e.labels,r),d.chartData=t("limitTo")(e.data,r),a.log("updateChart: updated chart")):a.log("updateChart: limit > arr.length"):e&&!n?(d.chartLabels=e.labels,d.chartData=e.data):n&&!e?(d.chartLabels=t("limitTo")(d.chartLabels,r),d.chartData=t("limitTo")(d.chartData,r)):a.error("updateChart: bad params")}function l(e){d.transactionHistory=e;var t=c(e);d.studentTransactions=t.student,d.familyTransactions=t.family,u("CAFETERIA-STUDENT"===d.current?d.studentTransactions:d.familyTransactions),r(function(){u(null,10)},9e3)}var d=this;d.refresh=function(){n.refresh(["cafeteriaMenu","cafeteriaTransactions"]).then(function(e){e.cafeteriaMenu&&i(e.cafeteriaMenu),e.cafeteriaTransactions&&l(e.cafeteriaTransactions)})},d.switch=function(){var e;"CAFETERIA-STUDENT"===d.current?(d.current="CAFETERIA-FAMILY",e=d.familyTransactions):(d.current="CAFETERIA-STUDENT",e=d.studentTransactions),u(e,10)},d.emptySearchBar=function(){d.searchBar={}},d.doShowSearchBar=function(){d.showSearchBar=d.showSearchBar!==!0,d.searchBar={},d.transactionLimit=d.showSearchBar===!0?d.transactionLimit+9:d.transactionLimit-9},d.transactionShowLess=function(){d.transactionLimit=d.transactionLimit-9,a.log(d.transactionLimit+" >= "+d.transactionHistory.length)},d.transactionShowMore=function(){d.transactionLimit=d.transactionLimit+9,a.log(d.transactionLimit+" < "+d.transactionHistory.length)},d.chartLabels=[],d.chartData=[],d.searchBar={},d.transactionLimit=3,d.current="CAFETERIA-STUDENT",s.anything("STUDENT_MENU","day").then(function(){return o.getStudentCafeteria()}).catch(function(){return e.getItem("STUDENT_MENU",!0).then(function(e){return e.data})}).then(i),s.anything("STUDENT_TRANSACTIONS","month").then(function(){return o.getStudentCredit()}).catch(function(){return e.getItem("STUDENT_TRANSACTIONS",!0).then(function(e){return e.data})}).then(l)}angular.module("studentaccess").controller("CafeteriaCtrl",["$localForage","$filter","$rootScope","$log","$timeout","StudentService","UpdateService",e])}(),function(){angular.module("studentaccess").component("confetti",{replace:!0,template:'<canvas id="{{::$ctrl.canvasId}}" style="position: absolute;display: block;width: 100%;z-index: -10;height: 100%;" ng-show="::$ctrl.showConfetti"></canvas>',controller:["$log","$timeout",function(e,t){var n=this;n.canvasId="canvasId"+Math.floor(1e3*Math.random()+1),e.debug("confetti: init"),e.debug("confetti: id = '"+n.canvasId+"'"),t(function(){"string"==typeof n.today&&"string"==typeof n.birthday&&n.today===n.birthday?(!function(t){function n(){r.clearRect(0,0,o,s);for(var e=0;e<i;e++){var t=c[e];r.beginPath(),r.lineWidth=t.r,r.strokeStyle=t.color,r.moveTo(t.x,t.y),r.lineTo(t.x+t.tilt+t.r/2,t.y+t.tilt),r.stroke()}a()}function a(){l+=.01;for(var e=0;e<i;e++){var t=c[e];t.y+=Math.cos(l+t.d)+t.r/2,t.x+=2*Math.sin(l),(t.x>o+5||t.x<-5||t.y>s)&&(e%3>0?c[e]={x:Math.random()*o,y:-10,r:t.r,d:t.d,color:t.color,tilt:t.tilt}:Math.sin(l)>0?c[e]={x:-5,y:Math.random()*s,r:t.r,d:t.d,color:t.color,tilt:t.tilt}:c[e]={x:o+5,y:Math.random()*s,r:t.r,d:t.d,color:t.color,tilt:t.tilt})}}e.debug("confetti: confetti()");for(var r=document.getElementById(t).getContext("2d"),o=window.innerWidth,s=window.innerHeight,i=60,c=[],u=0;u<i;u++)c.push({x:Math.random()*o,y:Math.random()*s,r:15*Math.random()+1,d:Math.random()*i,color:"rgba("+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", "+Math.floor(255*Math.random())+", 0.8)",tilt:Math.floor(5*Math.random())-5});var l=0;setInterval(n,20)}(n.canvasId),n.showConfetti=!0,e.debug("confetti: showing")):(n.showConfetti=!1,e.debug("confetti: not showing")),e.debug("confetti: "+n.today+" vs "+n.birthday)},1500)}],bindings:{today:"=",birthday:"="}})}(),function(){function e(e,t,n,a){function r(e){o.events=e,t.eventsList=$array.convertToObject(e)("ev_id")}var o=this;o.refresh=function(){t.refresh(["eventsEvents"]).then(function(e){e.eventsEvents&&r(e.eventsEvents)})},a.anything("STUDENT_EVENTS","day").then(function(){return n.getStudentEvents()}).catch(function(){return e.getItem("STUDENT_EVENTS",!0).then(function(e){return e.data})}).then(r)}angular.module("studentaccess").controller("EventsCtrl",["$localForage","$rootScope","StudentService","UpdateService",e])}(),function(){function e(e,t,n,a){var r=this;r.goEvents=function(){a.go("app.events")};var o=n.EVENTID;e.eventsList&&"{}"!==JSON.stringify(e.eventsList)&&o in e.eventsList?(r.eventSubject=e.eventsList[o].calc_subject,r.eventStartDate=e.eventsList[o].ev_date_start,r.eventStartTime=e.eventsList[o].ev_time_start,r.eventEndTime=e.eventsList[o].ev_time_end,r.eventEndDate=e.eventsList[o].ev_date_end,r.eventLocation=e.eventsList[o].calc_location,r.eventText=e.eventsList[o].calc_text,r.eventCalcStartDate=e.eventsList[o].calc_ev_date_start,r.eventCalcStartTime=e.eventsList[o].calc_ev_time_start):(r.goEvents(),t.error("EventsDetailsCtrl: data not found"))}angular.module("studentaccess").controller("EventsDetailsCtrl",["$rootScope","$log","$stateParams","$state",e])}(),function(){function e(e,t,n,a,r){function o(e){c.classes=e.classes,t.gradesClasses=$array.convertToObject(e.classes)("class_period")}function s(e){t.teachersList=$array.convertToObject(e)("teacher_id")}function i(e){e&&"[]"!==JSON.stringify(e)&&"0"===e.withhold_grades&&null!==e.overall_avg?c.totalAvg=e.overall_avg:e&&"[]"!==JSON.stringify(e)&&"1"===e.withhold_grades?c.totalAvg="$$.$":c.totalAvg="??.?"}var c=this;c.Math=window.Math,c.refresh=function(){t.refresh(["gradesSchedule","gradesGrades","gradesTeachers"]).then(function(e){e.gradesSchedule&&i(e.gradesSchedule),e.gradesGrades&&o(e.gradesGrades),e.gradesTeachers&&s(e.gradesTeachers)})},n.debug("once data is merged into one api call, fix this ctrl"),r.anything("STUDENT_SCHEDULE","month").then(function(){return a.getStudentSchedule()}).catch(function(){return e.getItem("STUDENT_SCHEDULE",!0).then(function(e){return e.data})}).then(i),r.anything("STUDENT_GRADES","day").then(function(){return a.getStudentGrades()}).catch(function(){return e.getItem("STUDENT_GRADES",!0).then(function(e){return e.data})}).then(o),r.anything("TEACHERS","month").then(function(){return a.getStudentTeachersData()}).catch(function(){return e.getItem("TEACHERS",!0).then(function(e){return e.data})}).then(s)}angular.module("studentaccess").controller("GradesCtrl",["$localForage","$rootScope","$log","StudentService","UpdateService",e])}(),function(){function e(e,t,n,a,r){var o=this;o.Math=window.Math,o.isFinite=window.isFinite,o.goGrades=function(){r.go("app.grades")},n.$on("$ionicView.loaded",function(){var n=a.PERIODID,r=a.TEACHERID;e.gradesClasses&&"{}"!==JSON.stringify(e.gradesClasses)&&n in e.gradesClasses?(o.gradeClass=e.gradesClasses[n].class_name,o.gradeClassPeriod=e.gradesClasses[n].class_period,o.gradeClassDesc=e.gradesClasses[n].class_description,o.gradeClassRoom=e.gradesClasses[n].class_room,o.gradeBreakdown=e.gradesClasses[n].class_scale,o.gradeLastUpdate=e.gradesClasses[n].class_updated,o.gradeAverage=e.gradesClasses[n].class_avg,o.gradeGrades=e.gradesClasses[n].grades):(o.goGrades(),t.error("GradesDetailsCtrl: data not found")),e.teachersList&&"{}"!==JSON.stringify(e.teachersList)&&r in e.teachersList?(o.gradeTeacherName=e.teachersList[r].teacher_name,o.gradeTeacherEmail=e.teachersList[r].teacher_email,o.gradeTeacherPhone=e.teachersList[r].teacher_phone,o.gradeTeacherPic=e.teachersList[r].teacher_pic,document.getElementById("teacherPicture").src="data:image/jpeg;base64,"+e.teachersList[r].teacher_pic):t.error("GradesDetailsCtrl: data not found")})}angular.module("studentaccess").controller("GradesDetailsCtrl",["$rootScope","$log","$scope","$stateParams","$state",e])}(),function(){function e(e,t,n,a,r,o,s,i){function c(){o.show({titleText:"<h3>"+r("translate")("HOMEWORK-PICK-CLASS-FILTER")+"</h3>",buttons:d.classes,destructiveText:r("translate")("HOMEWORK-CLEAR-CLASS-FILTER"),cancelText:r("translate")("HOMEWORK-CANCEL-CLASS-FILTER"),cancel:function(){a.log("actionSheet CANCELLED")},buttonClicked:function(e){return d.homeworkFilter.filter=d.classes[e].text,a.log("CLASS PICKED  place in list:",e," ",d.classes[e].text),!0},destructiveButtonClicked:function(){return a.log("CLEARED the filter"),d.homeworkFilter={},!0}})}function u(){n.alert({title:r("translate")("HOMEWORK-NOHOMEWORK"),template:"<center>"+r("translate")("HOMEWORK-NOHOMEWORK-TEXT")+"</center>"})}function l(e){d.homeworkCheckList=e,"[]"!==JSON.stringify(e)?(d.classes=$array.filterByKey(d.homeworkCheckList)("calc_class","text"),d.homeworkFilter={},d.doShowFilterOptions=c):d.doShowFilterOptions=u}var d=this;d.refresh=function(){t.refresh(["homeworkHomework"]).then(function(e){e.homeworkHomework&&l(e.homeworkHomework)})},i.anything("STUDENT_HOMEWORK","day").then(function(){return s.getStudentHomework()}).catch(function(){return e.getItem("STUDENT_HOMEWORK",!0).then(function(e){return e.data})}).then(l)}angular.module("studentaccess").controller("HomeworkCtrl",["$localForage","$rootScope","$ionicPopup","$log","$filter","$ionicActionSheet","StudentService","UpdateService",e])}(),function(){function e(e,t,n,a,r,o,s,i,c,u){var l=this;l.ncaLogo='<img class="ncaLogo" src="./img/icon.png" />StudentAccess',l.data={},r.$on("loginBegin",function(){n.show({template:'<ion-item style="width:250px;color:white">'+t("translate")("LOGIN-LOADING")+'</ion-item><div style="left:27px;height:70px" class="loader"><div class="loader-inner pacman"><div></div><div></div><div></div><div></div><div></div></div></div>'})}),r.$on("teachersDataDone",function(){n.hide()}),u.getItem("STUDENT_CHOSEN_THEME",!0).then(function(t){r.themeCss=t,e.info(t+" was loaded as chosen theme from login")},function(){r.themeCss="mild"}),u.getItem("STUDENT_CHOSEN_LANGUAGE",!0).then(function(t){a.use(t),l.selectedLang=t,e.info(t+" was loaded as chosen language from login")},function(){l.selectedLang="en"}),l.login=function(t){r.$broadcast("loginBegin"),e.info("login.login() called"),i.login(t.usernameInput,t.passwordInput).then(function(t){o.go("app.profile"),e.info("authservice.login was called"),l.data={}},function(e){n.hide(),"success"===c.check(e)?(l.data.passwordInput="",s.alert({title:"Login failed!",template:"<center>Check your User ID and password!</center>"})):"else"===e&&s.alert({title:"Unspecified error!",template:"<center>An error was detected, please try again.</center>"})})},r.show=!0}angular.module("studentaccess").controller("LoginCtrl",["$log","$filter","$ionicLoading","$translate","$rootScope","$state","$ionicPopup","AuthService","NetworkService","$localForage",e])}(),function(){function e(e,t,n,a,r,o,s,i,c,u,l,d,E,S,T,f){function g(){return t(function(t,n){e.getItem("STUDENT_PHOTO",!0).then(function(e){var a=e.filter(function(e){return e.userID===o.userInputsName});a.length?t(a[0].pic):n(o.userInputsName+"'s picture not found")},function(){n("No pictures found")})})}function h(){n.debug("refreshed everything"),S.anything("STUDENT_MISSING","day").then(function(){E.getStudentMissing()}),S.anything("STUDENT_HOMEWORK","day").then(function(){E.getStudentHomework()}),S.anything("STUDENT_GRADES","day").then(function(){E.getStudentGrades()}),S.anything("STUDENT_SCHEDULE","month").then(function(){E.getStudentSchedule()}),S.anything("TEACHERS","month").then(function(){E.getStudentTeachersData()}),S.anything("STUDENT_EVENTS","day").then(function(){E.getStudentEvents()}),S.anything("STUDENT_MENU","day").then(function(){E.getStudentCafeteria()}),S.anything("STUDENT_TRANSACTIONS","month").then(function(){E.getStudentCredit()}),S.anything("STAFF","month").then(function(){E.getStudentStaff()}),S.anything("SCHEDULES","month").then(function(){E.getSchedulesData()})}n.debug("app"),o.refresh=function(e){var a={profileMissing:E.getStudentMissing(),profileStudent:E.getStudentData(),profileSchedules:E.getSchedulesData(),homeworkHomework:E.getStudentHomework(),gradesSchedule:E.getStudentSchedule(),gradesGrades:E.getStudentGrades(),gradesTeachers:E.getStudentTeachersData(),eventsEvents:E.getStudentEvents(),cafeteriaMenu:E.getStudentCafeteria(),cafeteriaTransactions:E.getStudentCredit(),staffStaff:E.getStudentStaff()};return t.all(a).then(function(t){o.$broadcast("scroll.refreshComplete"),s.clearCache();var a={};if(e&&Array.isArray(e)){for(var r=0,i=e.length;r<i;r++)t[e[r]]&&(a[e[r]]=t[e[r]]);n.debug("refresh: all and returned "+e.join(", "))}else n.error("refresh: all and returned empty obj");return a},function(e){T.check(e.status),o.$broadcast("scroll.refreshComplete")})},o.ChangeLanguage=function(t){s.clearCache(),r.use(t),o.language=t,E.getStudentMissing(),E.getStudentHomework(),E.getStudentGrades(),E.getStudentEvents(),E.getStudentCafeteria(),E.getStudentStaff(),e.setItem("STUDENT_CHOSEN_LANGUAGE",t),n.debug(t+" is the chosen language")},o.ChangeTheme=function(t){o.themeCss=t,e.setItem("STUDENT_CHOSEN_THEME",t),n.debug(t+" is the new theme")},o.goBack=function(){s.goBack()},o.logout=function(){s.clearHistory(),s.clearCache(),delete o.studentPhoto,l.logout()},o.$on(d.notAuthenticated,function(e){l.logout(),s.clearCache(),s.clearHistory(),c.go("login"),u.alert({title:"Session Lost!",template:"Sorry, You have to login again."})}),h(),S.studentPic().then(function(){return E.getStudentPhoto()}).catch(function(e){return g()}).then(function(e){function t(){(document.getElementById("studentProfilePic")||document.getElementById("studentMenuPic"))&&(document.getElementById("studentProfilePic")&&(document.getElementById("studentProfilePic").src!=="data:image/jpeg;base64,"+e?(document.getElementById("studentProfilePic").src="data:image/jpeg;base64,"+e,n.debug("setPhoto: profile done")):n.debug("setPhoto: profile already set")),document.getElementById("studentMenuPic")&&(document.getElementById("studentMenuPic").src!=="data:image/jpeg;base64,"+e?(document.getElementById("studentMenuPic").src="data:image/jpeg;base64,"+e,n.debug("setPhoto: menu done")):n.debug("setPhoto: menu already set")))}o.studentPhoto="data:image/jpeg;base64,"+e,f(function(){t()},1700,2,!1)}),e.getItem("STUDENT_CHOSEN_LANGUAGE",!0).then(function(e){r.use(e),n.debug(e+" was loaded as chosen language"),o.language=e},function(){o.language="en"}),o.langs=[{name:"English",lang:"en"},{name:"Español",lang:"es"}],e.getItem("STUDENT_CHOSEN_THEME",!0).then(function(e){o.themeCss=e,n.debug(e+" was loaded as chosen theme")},function(){o.themeCss="mild"}),o.themes=[{name:"SETTINGS-THEME-LIGHT",url:"light"},{name:"SETTINGS-THEME-MILD",url:"mild"},{name:"SETTINGS-THEME-DARK",url:"dark"}],S.anything("STUDENT_LOGIN","day").then(function(){return E.getStudentData()}).catch(function(){return e.getItem("STUDENT_LOGIN",!0).then(function(e){return e.data})}).then(function(e){if("{}"!==JSON.stringify(e)){var t=e.birthdate.split("-"),n={Jan:"01",Feb:"02",Mar:"03",Apr:"04",May:"05",Jun:"06",Jul:"07",Aug:"08",Sep:"09",Oct:"10",Nov:"11",Dec:"12"};o.birthday=n[t[1]]+"-"+t[0]}var a=o.date.split("-");o.today=a[1]+"-"+parseInt(a[2])}),o.show=!0}angular.module("studentaccess").controller("AppCtrl",["$localForage","$q","$log","$timeout","$translate","$rootScope","$ionicHistory","$ionicSideMenuDelegate","$state","$ionicPopup","AuthService","AUTH_EVENTS","StudentService","UpdateService","NetworkService","$interval",e])}(),function(){function e(e,t,n,a,r,o,s,i,c,u){function l(e){S.missingsNumber=e.num_missing,S.missingMissing=e.missing}function d(e){"{}"!==JSON.stringify(e)&&(S.eagleCredits=e.credit_student,S.eagleCreditsFam=e.credit_family,S.studentBirthday=e.birthdate,S.studentGrade=e.grade)}function E(e){S.schedules=e,S.schedule=e[0]}var S=this;S.refresh=function(){n.refresh(["profileMissing","profileStudent","profileSchedules"]).then(function(e){e.profileMissing&&l(e.profileMissing),e.profileStudent&&d(e.profileStudent),e.profileSchedules&&E(e.profileSchedules)})},S.doShowMissing=function(){S.missingsNumber&&(S.showMissing=!S.showMissing)},S.goGrades=function(){o.go("app.grades")},S.doShowActionSheet=function(){r.show({titleText:"<h3>Pick a Schedule</h3>",buttons:S.schedules,cancelText:a("translate")("HOMEWORK-CANCEL-CLASS-FILTER"),cancel:function(){t.log("actionSheet CANCELLED")},buttonClicked:function(e){return S.schedule=S.schedules[e],t.log("schedule in list: ",e," ",S.schedules[e].type),!0}})},i.anything("STUDENT_MISSING","day").then(function(){return s.getStudentMissing()}).catch(function(){return e.getItem("STUDENT_MISSING",!0).then(function(e){return e.data})}).then(l),i.anything("STUDENT_LOGIN","day").then(function(){return s.getStudentData()}).catch(function(){return e.getItem("STUDENT_LOGIN",!0).then(function(e){return e.data})}).then(d),i.anything("SCHEDULES","month").then(function(){return s.getSchedulesData()}).catch(function(){return e.getItem("SCHEDULES",!0).then(function(e){return e.data})}).then(E)}angular.module("studentaccess").controller("ProfileCtrl",["$localForage","$log","$rootScope","$filter","$ionicActionSheet","$state","StudentService","UpdateService","$ionicPopover","$scope",e])}(),function(e){function t(e,t,n,a,r,o){function s(e,t){window.localStorage.auth="true",S=!0,a.personName="Jacob Orozco"===e.person_name?"LOL":e.person_name,a.userInputsName=t.user,a.userInputsPass=t.pass}function i(e,t){r.setItem(["USER_INPUTS","STUDENT_LOGIN"],[t,o.attachDate(e)]),s(e,t)}function c(){r.getItem(["STUDENT_LOGIN","USER_INPUTS"],!0).then(function(e){s(e[0].data,e[1])},function(){S=!1,window.localStorage.auth="false"})}function u(e,a){return t(function(t,s){n({url:E,method:"GET",params:{mode:"student",query:"login",username:e,password:a}}).then(function(n){d=n.data,1===d.login_status?(i(d,{user:e,pass:a}),t("success"),r.setItem("STUDENT_LOGIN",o.attachDate(d))):s("fail")},function(e){s(e.status<=0?0:"else")})})}function l(){S=!1,window.localStorage.auth="false",r.removeItem(["STUDENT_LOGIN","STUDENT_MISSING","STUDENT_HOMEWORK","STUDENT_SCHEDULE","STUDENT_GRADES","STUDENT_EVENTS","STUDENT_MENU","STUDENT_TRANSACTIONS","SCHEDULES","STAFF","TEACHERS","USER_INPUTS"])}var d,E="https://db.nca.edu.ni/api/api_ewapp.php",S=!1;return returns={login:u,logout:l},c(),returns}e.module("studentaccess").service("AuthService",["$log","$q","$http","$rootScope","$localForage","StudentService",t])}(window.angular),function(e){function t(e,t,n,a,r,o){function s(){n.alert({title:"Ooops!",template:"<center>It seems you're offline. Please check your network connection.</center>"})}function i(e){return e<=0?(s(),"fail"):"success"}function c(n){var a="";"offline"===n&&(a=" Please check your network connection");var r='<div class="network"><div class="card"><ion-item class="item-input item-text-wrap"><p>You are '+n+"!"+a+"</p></ion-item></div></div>",s=jqLite(r);e.log(n),t.append(s),o(function(){s.remove()},5e3)}var u={check:i,popup:s,alert:c};return u}e.module("studentaccess").service("NetworkService",["$log","$ionicBody","$ionicPopup","$http","$rootScope","$timeout",t]),jqLite=e.element}(window.angular),function(e){function t(e,t,n,a,r,o,s){function i(){o.date=e("date")(new Date,"yyyy-MM-dd"),t.debug("todays date: "+o.date)}function c(e){return{date:o.date,data:e}}function u(){return r({url:"./components/profile/schedules.json",method:"GET"}).then(function(e){var n=e.data;return n?s.setItem("SCHEDULES",c(n)):t.error("Failed to get studentData!"),n})}function l(e){s.getItem("STUDENT_PHOTO").then(function(n){var a=o.userInputsName,r=[];n?r=n.map(function(e){return e.userID}):n=[],r.indexOf(a)<0?(n.push({userID:a,date:o.date,pic:e}),s.setItem("STUDENT_PHOTO",n),t.debug("newPic: success")):t.debug("newPic: userAlreadyExists")})}function d(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"login",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data;return n?s.setItem("STUDENT_LOGIN",c(n)):t.error("Failed to get studentData!"),n})}function E(){return r({url:A,method:"GET",params:{query:"events",mode:"student",lang:o.language,username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data.events;return n?s.setItem("STUDENT_EVENTS",c(n)):t.error("Failed to get events!"),n})}function S(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"homework",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data.homework;return n?s.setItem("STUDENT_HOMEWORK",c(n)):t.error("Failed to get hw!"),n})}function T(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,
query:"allgrades",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data;return n?s.setItem("STUDENT_GRADES",c(n)):t.error("Failed to get grades!"),n})}function f(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"schedule",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data;return n?s.setItem("STUDENT_SCHEDULE",c(n)):t.error("Failed to getschedule!"),n})}function g(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"allteachers",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){o.$broadcast("teachersDataDone");var n=e.data.teachers;return n?(s.setItem("TEACHERS",c(n)),t.debug("Success. we got teachers data")):t.error("Failed to get teachers data!"),n},function(e){o.$broadcast("teachersDataDone")})}function h(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"cafeteria",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data.menu;return n?s.setItem("STUDENT_MENU",c(n)):t.error("Failed to get food!"),n})}function m(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"credit",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data.transactions;return n?s.setItem("STUDENT_TRANSACTIONS",c(n)):t.error("Failed to get credit history!"),n})}function I(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"missing",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data;return n?s.setItem("STUDENT_MISSING",c(n)):t.error("Failed to get missing ass.!"),n})}function N(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"staff",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data.staff_list;return n?s.setItem("STAFF",c(n)):t.error("Failed to get staff list!"),n})}function p(){return r({url:A,method:"GET",params:{mode:"student",lang:o.language,query:"myphoto",username:o.userInputsName,password:o.userInputsPass}}).then(function(e){var n=e.data;return n?l(n):t.error("Failed to get photo!"),n})}var A="https://db.nca.edu.ni/api/api_ewapp.php",C={attachDate:c,getSchedulesData:u,getStudentCredit:m,getStudentEvents:E,getStudentData:d,getStudentHomework:S,getStudentCafeteria:h,getStudentMissing:I,getStudentSchedule:f,getStudentGrades:T,getStudentStaff:N,getStudentPhoto:p,getStudentTeachersData:g};return t.debug("stu"),i(),C}e.module("studentaccess").service("StudentService",["$filter","$log","$timeout","$q","$http","$rootScope","$localForage",t])}(window.angular),function(e){function t(e,t,n,a){function r(){return t(function(t,r){a.getItem(["STUDENT_PHOTO","USER_INPUTS"],!0).then(function(a){var o,s,i=e.date.split("-"),c=i[0]+"-"+i[1],u=a[0].filter(function(e){return e.userID===a[1].user});u.length?(o=u[0].date.split("-"),s=o[0]+"-"+o[1],c!==s?(t("get new pic"),n.debug("US.studentPic: get new pic")):(r("pic still valid"),n.debug("US.studentPic: pic still valid"))):t("current user does not exist")},function(){t("undef"),n.debug("US.studentPic: was undef")})})}function o(r,o){return t(function(t,s){r&&o?a.getItem(r,!0).then(function(a){var i,c,u=e.date.split("-"),l=a.date.split("-");"month"===o?(i=u[0]+"-"+u[1],c=l[0]+"-"+l[1]):"day"===o?(i=e.date,c=a.date):n.error("US.anything: bad mode"),i===c?(s("still valid"),n.debug("US.anything: "+r+" still valid")):(t("make call"),n.debug("US.anything: "+r+" outdated"))},function(){t("undef"),n.debug("US.anything: "+r+" was undef")}):n.error("US.anything: bad params")})}var s={studentPic:r,anything:o};return s}e.module("studentaccess").service("UpdateService",["$rootScope","$q","$log","$localForage",t])}(window.angular),function(){function e(e,t,n,a,r,o){var s=this;s.doShowDeletePics=function(){r.getItem("STUDENT_PHOTO",!0).then(function(s){s.length>1?e.confirm({title:a("translate")("SETTINGS-DELETE-TITLE"),template:'<div style="text-align:center">'+a("translate")("SETTINGS-DELETE-PICS-MESSAGE")+"</div>",cancelText:a("translate")("SETTINGS-CANCEL"),okType:"button-assertive",okText:a("translate")("SETTINGS-DELETE")}).then(function(e){if(e){t.show({template:'<ion-item style="width:250px;color:white">'+a("translate")("LOGIN-LOADING")+'</ion-item><div style="left:27px;height:70px" class="loader"><div class="loader-inner pacman"><div></div><div></div><div></div><div></div><div></div></div></div>'});var i=[];i=s.filter(function(e){return e.userID===o.userInputsName}),r.setItem("STUDENT_PHOTO",i),n(function(){t.hide()},4500)}}):e.alert({title:a("translate")("SETTINGS-NO-PICS")})})}}angular.module("studentaccess").controller("SettingsCtrl",["$ionicPopup","$ionicLoading","$timeout","$filter","$localForage","$rootScope",e])}(),function(){function e(e,t,n,a,r,o){function s(e){i.staffList=e,n.staffList=$array.convertToObject(e)("t_id")}var i=this;i.loadMore=function(){i.limit+=10,e.$broadcast("scroll.infiniteScrollComplete")},i.emptySearchBar=function(){i.searchBar.bar=""},i.doShowSearchBar=function(){i.showSearchBar=!i.showSearchBar,i.searchBar.bar=""},i.refresh=function(){n.refresh(["staffStaff"]).then(function(e){e.staffStaff&&s(e.staffStaff)})},o.anything("STAFF","month").then(function(){return r.getStudentStaff()}).catch(function(){return t.getItem("STAFF",!0).then(function(e){return e.data})}).then(s),i.searchBar={},i.limit=15}angular.module("studentaccess").controller("StaffCtrl",["$scope","$localForage","$rootScope","$log","StudentService","UpdateService",e])}(),function(){function e(e,t,n,a){var r=this;r.goStaff=function(){n.go("app.staff")};var o=a.STAFFID;e.staffList&&"{}"!==JSON.stringify(e.staffList)&&o in e.staffList?(r.staffStatus=e.staffList[o].calc_status,r.staffName=e.staffList[o].calc_name,r.staffHomePhone=e.staffList[o].calc_homephone,r.staffPhone=e.staffList[o].calc_phone,r.staffEmail=e.staffList[o].calc_email):(r.goStaff(),t.error("StaffDetailsCtrl: data not found"))}angular.module("studentaccess").controller("StaffDetailsCtrl",["$rootScope","$log","$state","$stateParams",e])}();